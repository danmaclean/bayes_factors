<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 7 Bayes Factor on Contingency Tables and Proportions | Bayesian Inference with Bayes Factors</title>
  <meta name="description" content="Topic 7 Bayes Factor on Contingency Tables and Proportions | Bayesian Inference with Bayes Factors" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 7 Bayes Factor on Contingency Tables and Proportions | Bayesian Inference with Bayes Factors" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 7 Bayes Factor on Contingency Tables and Proportions | Bayesian Inference with Bayes Factors" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2021-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayes-factor-anova.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Bayesian Inference Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setting up</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#knowledge-prerequisites"><i class="fa fa-check"></i><b>1.1.1</b> Knowledge prerequisites</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#software-prerequisites"><i class="fa fa-check"></i><b>1.1.2</b> Software prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages-in-rstudio"><i class="fa fa-check"></i><b>1.4</b> Installing R packages in RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#standard-packages"><i class="fa fa-check"></i><b>1.4.1</b> Standard packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a><ul>
<li class="chapter" data-level="2.1" data-path="motivation.html"><a href="motivation.html#mr.-micawbers-rule-of-statistical-inference"><i class="fa fa-check"></i><b>2.1</b> Mr. Micawber’s rule of statistical inference</a></li>
<li class="chapter" data-level="2.2" data-path="motivation.html"><a href="motivation.html#learning-to-select-hypotheses-using-bayesian-approaches"><i class="fa fa-check"></i><b>2.2</b> Learning to select hypotheses using Bayesian approaches</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>3</b> R Fundamentals</a><ul>
<li class="chapter" data-level="3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#about-this-chapter"><i class="fa fa-check"></i><b>3.1</b> About this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#working-with-r"><i class="fa fa-check"></i><b>3.2</b> Working with R</a></li>
<li class="chapter" data-level="3.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#variables"><i class="fa fa-check"></i><b>3.3</b> Variables</a><ul>
<li class="chapter" data-level="3.3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-objects-and-functions"><i class="fa fa-check"></i><b>3.3.1</b> Using objects and functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#dataframes"><i class="fa fa-check"></i><b>3.4</b> Dataframes</a></li>
<li class="chapter" data-level="3.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#packages"><i class="fa fa-check"></i><b>3.5</b> Packages</a></li>
<li class="chapter" data-level="3.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-r-help"><i class="fa fa-check"></i><b>3.6</b> Using R Help</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>4</b> Bayesian Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#about-this-chapter-1"><i class="fa fa-check"></i><b>4.1</b> About this chapter</a></li>
<li class="chapter" data-level="4.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#frequentist-and-bayesian-interpretations-of-probability"><i class="fa fa-check"></i><b>4.2</b> Frequentist and Bayesian Interpretations of Probability</a><ul>
<li class="chapter" data-level="4.2.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#frequentist-probability"><i class="fa fa-check"></i><b>4.2.1</b> Frequentist Probability</a></li>
<li class="chapter" data-level="4.2.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayesian-probablity"><i class="fa fa-check"></i><b>4.2.2</b> Bayesian Probablity</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayes-theorem-by-rough-example"><i class="fa fa-check"></i><b>4.3</b> Bayes Theorem by Rough Example</a></li>
<li class="chapter" data-level="4.4" data-path="bayesian-inference.html"><a href="bayesian-inference.html#hypotheses-in-frequentist-and-bayesian-statistics"><i class="fa fa-check"></i><b>4.4</b> Hypotheses in Frequentist and Bayesian Statistics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#frequentist-hypotheses"><i class="fa fa-check"></i><b>4.4.1</b> Frequentist Hypotheses</a></li>
<li class="chapter" data-level="4.4.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayesian-hypotheses"><i class="fa fa-check"></i><b>4.4.2</b> Bayesian Hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayes-factors"><i class="fa fa-check"></i><b>4.5</b> Bayes Factors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html"><i class="fa fa-check"></i><b>5</b> Bayes Factor <span class="math inline">\(t\)</span>-tests</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#about-this-chapter-2"><i class="fa fa-check"></i><b>5.1</b> About this chapter</a></li>
<li class="chapter" data-level="5.2" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#a-frequentist-t-test"><i class="fa fa-check"></i><b>5.2</b> A Frequentist <span class="math inline">\(t\)</span>-test</a><ul>
<li class="chapter" data-level="5.2.1" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#the-plant-growth-data-set"><i class="fa fa-check"></i><b>5.2.1</b> The Plant Growth data set</a></li>
<li class="chapter" data-level="5.2.2" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#two-sample-t-test"><i class="fa fa-check"></i><b>5.2.2</b> Two Sample <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#a-bayesian-t-test"><i class="fa fa-check"></i><b>5.3</b> A Bayesian <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="5.4" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#comparing-p-and-the-bayes-factor-for-the-plantgrowth-data"><i class="fa fa-check"></i><b>5.4</b> Comparing <span class="math inline">\(p\)</span> and the Bayes Factor for the PlantGrowth data</a></li>
<li class="chapter" data-level="5.5" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#better-hypotheses---one-tailed-tests"><i class="fa fa-check"></i><b>5.5</b> Better Hypotheses - One-tailed tests</a><ul>
<li class="chapter" data-level="5.5.1" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#a-data-frame-based-gotcha"><i class="fa fa-check"></i><b>5.5.1</b> A data frame based gotcha</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#performing-the-one-tailed-test"><i class="fa fa-check"></i><b>5.6</b> Performing the One-tailed test</a></li>
<li class="chapter" data-level="5.7" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#testing-the-effect-of-the-prior"><i class="fa fa-check"></i><b>5.7</b> Testing the effect of the prior</a><ul>
<li class="chapter" data-level="5.7.1" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#the-cauchy-prior-distribution"><i class="fa fa-check"></i><b>5.7.1</b> The Cauchy Prior Distribution</a></li>
<li class="chapter" data-level="5.7.2" data-path="bayes-factor-t-tests.html"><a href="bayes-factor-t-tests.html#the-effect-of-changing-the-prior"><i class="fa fa-check"></i><b>5.7.2</b> The effect of changing the prior</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bayes-factor-anova.html"><a href="bayes-factor-anova.html"><i class="fa fa-check"></i><b>6</b> Bayes Factor ANOVA</a><ul>
<li class="chapter" data-level="6.1" data-path="bayes-factor-anova.html"><a href="bayes-factor-anova.html#about-this-chapter-3"><i class="fa fa-check"></i><b>6.1</b> About this chapter</a></li>
<li class="chapter" data-level="6.2" data-path="bayes-factor-anova.html"><a href="bayes-factor-anova.html#the-issue-of-multiplicity-in-frequentism-and-bayesianism"><i class="fa fa-check"></i><b>6.2</b> The issue of multiplicity in Frequentism and Bayesianism</a></li>
<li class="chapter" data-level="6.3" data-path="bayes-factor-anova.html"><a href="bayes-factor-anova.html#automating-bayesfactorttest-for-many-comparisions"><i class="fa fa-check"></i><b>6.3</b> Automating <code>BayesFactor::ttest()</code> for many comparisions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bayes-factor-on-contingency-tables-and-proportions.html"><a href="bayes-factor-on-contingency-tables-and-proportions.html"><i class="fa fa-check"></i><b>7</b> Bayes Factor on Contingency Tables and Proportions</a><ul>
<li class="chapter" data-level="7.1" data-path="bayes-factor-on-contingency-tables-and-proportions.html"><a href="bayes-factor-on-contingency-tables-and-proportions.html#about-this-chapter-4"><i class="fa fa-check"></i><b>7.1</b> About this chapter</a></li>
<li class="chapter" data-level="7.2" data-path="bayes-factor-on-contingency-tables-and-proportions.html"><a href="bayes-factor-on-contingency-tables-and-proportions.html#bayes-factor-chi2"><i class="fa fa-check"></i><b>7.2</b> Bayes Factor <span class="math inline">\(\chi^2\)</span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="bayes-factor-on-contingency-tables-and-proportions.html"><a href="bayes-factor-on-contingency-tables-and-proportions.html#converting-a-dataframe-to-a-contingency-table"><i class="fa fa-check"></i><b>7.2.1</b> Converting a dataframe to a contingency table</a></li>
<li class="chapter" data-level="7.2.2" data-path="bayes-factor-on-contingency-tables-and-proportions.html"><a href="bayes-factor-on-contingency-tables-and-proportions.html#bigger-contingency-tables"><i class="fa fa-check"></i><b>7.2.2</b> Bigger contingency tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Inference with Bayes Factors</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayes-factor-on-contingency-tables-and-proportions" class="section level1">
<h1><span class="header-section-number">Topic 7</span> Bayes Factor on Contingency Tables and Proportions</h1>
<div id="about-this-chapter-4" class="section level2">
<h2><span class="header-section-number">7.1</span> About this chapter</h2>
<ol style="list-style-type: decimal">
<li>Questions
<ul>
<li>How can I do a categoric count based <span class="math inline">\(\chi^2\)</span> or proportional test with Bayes Factors?</li>
</ul></li>
<li>Objectives
<ul>
<li>Perform <span class="math inline">\(\chi^2\)</span> on contingency tables of any size</li>
</ul></li>
<li>Keypoints
<ul>
<li><code>BayesFactor</code> and <code>simplebf</code> provide functions and automations for categorical count or frequency data</li>
<li>These are useful for HR scoring data</li>
</ul></li>
</ol>
<p>The <code>BayesFactor</code> package has some functions for performing other types of tests and returning a Bayes Factor. In this section we will briefly look at these.</p>
</div>
<div id="bayes-factor-chi2" class="section level2">
<h2><span class="header-section-number">7.2</span> Bayes Factor <span class="math inline">\(\chi^2\)</span></h2>
<p>A common question is whether proportions of counted things or frequency is different between samples. The one we typically learn first as biologists is Mendel’s pea data that led to his genetic insights, like this 2x2 table for flower colour (purple or white). Note that we have the counts of flower colour that were observed and expected counts that would come from a 3:1 Mendelian segregating cross.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb52-1"></a>mendel_data</span></code></pre></div>
<pre><code>##            P   W
## observed 459 141
## expected 450 150</code></pre>
<p>The <span class="math inline">\(\chi^2\)</span> test is the classical frequentist test performed to determine differences in proportions in a contingency table, and there is an equivalent Bayesian method in <code>BayesFactor</code>. We can run our data through the function <code>contingencyTableBF()</code> very easily, but it does need the data to be an R matrix object, not the more typical dataframe. We can change that easily with <code>as.matrix()</code>, then run the function.</p>
<p>The arguments are important: <code>fixedMargin</code> describes whether the variable of interest is in the rows or columns of the table - here it is in the columns so we use <code>cols</code>; <code>sampleType</code> describes what the function should do in the Bayesian sampling process as it runs. This is highly technical and out of scope for what we want to discuss, so I’m going to gloss over it. The function documentation has more information if you want it (<code>?contingencyTableBF</code>) the option used here <code>indepMulti</code> is a good one to start with.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb54-1"></a>mendel_matrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(mendel_data)</span>
<span id="cb54-2"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb54-2"></a></span>
<span id="cb54-3"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb54-3"></a><span class="kw">library</span>(BayesFactor)</span>
<span id="cb54-4"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb54-4"></a><span class="kw">contingencyTableBF</span>(mendel_matrix, <span class="dt">sampleType =</span> <span class="st">&quot;indepMulti&quot;</span>, <span class="dt">fixedMargin=</span><span class="st">&#39;cols&#39;</span>)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Non-indep. (a=1) : 0.1011097 ±0%
## 
## Against denominator:
##   Null, independence, a = 1 
## ---
## Bayes factor type: BFcontingencyTable, independent multinomial</code></pre>
<p>The hypotheses that are tested in this example are fixed and simple ones. Strictly <span class="math inline">\(H_0\)</span> is that the proportions in the table are equal and <span class="math inline">\(H_1\)</span> is that the proportions are not equal. So in effect the whole table is tested to see whether the observed counts are different to the expected counts. Here we see that the odds are 1:0.101 <em>against</em> <span class="math inline">\(H_1\)</span> so the conclusion is that the proportions are equal, that is our observed flower colour proportions match the expected.</p>
<p>There isn’t a way to use different <span class="math inline">\(H_1\)</span>’s in the way that we did with the Bayes Factor <span class="math inline">\(t\)</span>-test, so we can’t test the explicit hypothesis that one is bigger (or smaller than the other).</p>
<div id="converting-a-dataframe-to-a-contingency-table" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Converting a dataframe to a contingency table</h3>
<p>In most of our work we’ve used tidy data (or case based data) in dataframes. The function we just learned uses a contingency table in a matrix, not a dataframe. Sometimes too, we will want to make a contingency table to see it. We can make a contingency table out of a dataframe with the <code>table</code> function, we just have to select the columns we want using the <code>$</code> notation.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb56-1"></a>hr_df</span></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   strain  replicate score
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
## 1 control         1     1
## 2 mild            1     3
## 3 deadly          1     4
## 4 control         2     2
## 5 mild            2     3
## 6 deadly          2     4
## 7 control         3     1
## 8 mild            3     3
## 9 deadly          3     3</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb58-1"></a>hr_cont_table &lt;-<span class="st"> </span><span class="kw">table</span>(hr_df<span class="op">$</span>score,hr_df<span class="op">$</span>strain) </span></code></pre></div>
</div>
<div id="bigger-contingency-tables" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Bigger contingency tables</h3>
<p>Sometime we’ll have a contingency table of counts that is larger than 2 x 2 IE we have more than two samples and more than two levels of a variable. For example we might have this HR scoring table.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb59-1"></a>hr_table</span></code></pre></div>
<pre><code>##    
##     control deadly mild
##   1       2      0    0
##   2       1      0    0
##   3       0      1    3
##   4       0      2    0</code></pre>
<p>As we can see it shows an HR score in the rows and different strains in the columns. The numbers represent the count of times each score was seen in three replicated experiments. Because it’s a contingency table the replicates are merged in together. It is important therefore that the same amount of sampling was done in each strain.</p>
<p>Here we would want to compare the two basic hypotheses of whether the proportions of observed scores are different between the strains are the same or not. Let’s go ahead and do that with <code>contingencyTableBF()</code></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb61-1"></a><span class="kw">contingencyTableBF</span>(hr_table, <span class="dt">sampleType =</span> <span class="st">&quot;indepMulti&quot;</span>, <span class="dt">fixedMargin =</span> <span class="st">&quot;cols&quot;</span>)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Non-indep. (a=1) : 11.55 ±0%
## 
## Against denominator:
##   Null, independence, a = 1 
## ---
## Bayes factor type: BFcontingencyTable, independent multinomial</code></pre>
<p>We get a clear answer, the Bayes Factor strongly favours the hypothesis that the proportions of scores across strains are not equal. Which is nice but it doesn’t go far enough - it doesn’t tell us which are bigger than others and whether the conclusion applies to all the possible pairings of strains. This is the same problem we had with the Bayes Factor <span class="math inline">\(t\)</span>-test and the solution is the same. We can just pull out each pair of strains and compare them one pair at a time. All we need is a book-keeping method to do this. The library <code>simplebf</code> contains one, so let’s use that.</p>
<p>We can use the <code>allpairs_proportionbf()</code> function to get a data frame of Bayes Factors. If you pass this function a dataframe it will make the contingency table for you. You must specify which columns to use for the group and the counts. For easy reading we’ll send the output to the <code>knitr::kable()</code> function.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb63-1"></a><span class="kw">library</span>(simplebf)</span>
<span id="cb63-2"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb63-2"></a><span class="kw">allpairs_proportionbf</span>(hr_df, </span>
<span id="cb63-3"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb63-3"></a>                        <span class="dt">group_col =</span> <span class="st">&quot;strain&quot;</span>, <span class="dt">count_col =</span> <span class="st">&quot;score&quot;</span>, </span>
<span id="cb63-4"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb63-4"></a>                        <span class="dt">sample_type =</span> <span class="st">&quot;indepMulti&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb63-5"><a href="bayes-factor-on-contingency-tables-and-proportions.html#cb63-5"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="5%" />
<col width="25%" />
<col width="27%" />
<col width="6%" />
<col width="4%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">control_group</th>
<th align="left">test_group</th>
<th align="left">h_0</th>
<th align="left">h_1</th>
<th align="right">BayesFactor</th>
<th align="left">odds_h_1</th>
<th align="left">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">control</td>
<td align="left">mild</td>
<td align="left">mild proportions equal to control proportions</td>
<td align="left">mild proportions not equal to control proportions</td>
<td align="right">5.6000</td>
<td align="left">1:5.6</td>
<td align="left">Substantial evidence for H_1 compared to H_0</td>
</tr>
<tr class="even">
<td align="left">control</td>
<td align="left">deadly</td>
<td align="left">deadly proportions equal to control proportions</td>
<td align="left">deadly proportions not equal to control proportions</td>
<td align="right">4.2000</td>
<td align="left">1:4.2</td>
<td align="left">Substantial evidence for H_1 compared to H_0</td>
</tr>
<tr class="odd">
<td align="left">mild</td>
<td align="left">deadly</td>
<td align="left">deadly proportions equal to mild proportions</td>
<td align="left">deadly proportions not equal to mild proportions</td>
<td align="right">2.1875</td>
<td align="left">1:2.1875</td>
<td align="left">Anecdotal evidence for H_1 compared to H_0</td>
</tr>
</tbody>
</table>
<p>So we get a nice set of Bayesian Hypothesis test for proportion or contingency table data on our HR experiment.</p>

<div class="roundup">
<ul>
<li>Bayes Factors can be used for proportion tests like the <span class="math inline">\(\chi^2\)</span></li>
<li>The <code>BayesFactor</code> and <code>simplebf</code> packages are useful tools implementing these</li>
</ul>
</div>


</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayes-factor-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bayes_factors.pdf", "bayes_factors.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
