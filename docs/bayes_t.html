<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Bayes Factor t-tests â€“ Bayesian Inference with Bayes Factors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bayes_anova.html" rel="next">
<link href="./bayes_factor_intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ed6da6eef3892af8a4b5ed59bfb951f5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./bayes_t.html">Tests with Bayes Factors</a></li><li class="breadcrumb-item"><a href="./bayes_t.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bayes Factor <span class="math inline">\(t\)</span>-tests</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Inference with Bayes Factors</a> 
        <div class="sidebar-tools-main">
    <a href="./Bayesian-Inference-with-Bayes-Factors.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motivation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Background</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes_factor_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Tests with Bayes Factors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes_t.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bayes Factor <span class="math inline">\(t\)</span>-tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayes Factor ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayes Factor on Contingency Tables and Proportions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Fundamentals</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#about-this-chapter" id="toc-about-this-chapter" class="nav-link active" data-scroll-target="#about-this-chapter"><span class="header-section-number">2.1</span> About this chapter</a></li>
  <li><a href="#a-frequentist-t-test" id="toc-a-frequentist-t-test" class="nav-link" data-scroll-target="#a-frequentist-t-test"><span class="header-section-number">2.2</span> A Frequentist <span class="math inline">\(t\)</span>-test</a>
  <ul class="collapse">
  <li><a href="#the-plant-growth-data-set" id="toc-the-plant-growth-data-set" class="nav-link" data-scroll-target="#the-plant-growth-data-set"><span class="header-section-number">2.2.1</span> The Plant Growth data set</a></li>
  <li><a href="#two-sample-t-test" id="toc-two-sample-t-test" class="nav-link" data-scroll-target="#two-sample-t-test"><span class="header-section-number">2.2.2</span> Two Sample <span class="math inline">\(t\)</span>-test</a></li>
  </ul></li>
  <li><a href="#a-bayesian-t-test" id="toc-a-bayesian-t-test" class="nav-link" data-scroll-target="#a-bayesian-t-test"><span class="header-section-number">2.3</span> A Bayesian <span class="math inline">\(t\)</span>-test</a></li>
  <li><a href="#comparing-p-and-the-bayes-factor-for-the-plantgrowth-data" id="toc-comparing-p-and-the-bayes-factor-for-the-plantgrowth-data" class="nav-link" data-scroll-target="#comparing-p-and-the-bayes-factor-for-the-plantgrowth-data"><span class="header-section-number">2.4</span> Comparing <span class="math inline">\(p\)</span> and the Bayes Factor for the PlantGrowth data</a></li>
  <li><a href="#better-hypotheses---one-tailed-tests" id="toc-better-hypotheses---one-tailed-tests" class="nav-link" data-scroll-target="#better-hypotheses---one-tailed-tests"><span class="header-section-number">2.5</span> Better Hypotheses - One-tailed tests</a>
  <ul class="collapse">
  <li><a href="#a-data-frame-based-gotcha" id="toc-a-data-frame-based-gotcha" class="nav-link" data-scroll-target="#a-data-frame-based-gotcha"><span class="header-section-number">2.5.1</span> A data frame based gotcha</a></li>
  </ul></li>
  <li><a href="#performing-the-one-tailed-test" id="toc-performing-the-one-tailed-test" class="nav-link" data-scroll-target="#performing-the-one-tailed-test"><span class="header-section-number">2.6</span> Performing the One-tailed test</a></li>
  <li><a href="#testing-the-effect-of-the-prior" id="toc-testing-the-effect-of-the-prior" class="nav-link" data-scroll-target="#testing-the-effect-of-the-prior"><span class="header-section-number">2.7</span> Testing the effect of the prior</a>
  <ul class="collapse">
  <li><a href="#the-cauchy-prior-distribution" id="toc-the-cauchy-prior-distribution" class="nav-link" data-scroll-target="#the-cauchy-prior-distribution"><span class="header-section-number">2.7.1</span> The Cauchy Prior Distribution</a></li>
  <li><a href="#the-effect-of-changing-the-prior" id="toc-the-effect-of-changing-the-prior" class="nav-link" data-scroll-target="#the-effect-of-changing-the-prior"><span class="header-section-number">2.7.2</span> The effect of changing the prior</a></li>
  </ul></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://tsl-bioinformatics.shinyapps.io/nonfreqstats_chatbot/" target="_blank"><i class="bi bi-link-45deg"></i>Introduction to Non-Frequentist Statistics Chatbot</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./bayes_t.html">Tests with Bayes Factors</a></li><li class="breadcrumb-item"><a href="./bayes_t.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bayes Factor <span class="math inline">\(t\)</span>-tests</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bayes Factor <span class="math inline">\(t\)</span>-tests</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="about-this-chapter" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="about-this-chapter"><span class="header-section-number">2.1</span> About this chapter</h2>
<ol type="1">
<li>Questions
<ul>
<li>How can I do compare two continuous samples with Bayes Factors?</li>
<li>How can I specify a directional hypothesis?</li>
<li>How much difference does the prior make?</li>
</ul></li>
<li>Objectives
<ul>
<li>Understand how a Bayes Factor <span class="math inline">\(t\)</span>-test can be done in R</li>
<li>Consider how <span class="math inline">\(p\)</span> and the Bayes Factor are not contradictory</li>
<li>Understand that hypothesis and prior selection is important</li>
</ul></li>
<li>Keypoints
<ul>
<li>The <code>BayesFactor</code> package provides functions for Bayes Factor analysis</li>
<li>Bayes Factors and <span class="math inline">\(p\)</span>-values ask very different questions</li>
<li>One-tailed tests are possible and may be better options</li>
</ul></li>
</ol>
<p>In this section weâ€™ll look at how we can do a <span class="math inline">\(t\)</span>-test-like two sample comparison with Bayes Factors. The process is surprisingly straight forward but does need us to pay attention to the weaknesses of the Bayes method - specifically choosing the prior probability distribution. To actually do the tests weâ€™ll use the <code>ttestBF()</code> in the <code>BayesFactor</code> package.</p>
</section>
<section id="a-frequentist-t-test" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="a-frequentist-t-test"><span class="header-section-number">2.2</span> A Frequentist <span class="math inline">\(t\)</span>-test</h2>
<p>To begin weâ€™ll first do a normal <span class="math inline">\(t\)</span>-test with a sample data set as a basis for later comparison</p>
<section id="the-plant-growth-data-set" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="the-plant-growth-data-set"><span class="header-section-number">2.2.1</span> The Plant Growth data set</h3>
<p>You may recall the Plant Growth data set we used in the Linear Models course, hereâ€™s a reminder</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     weight       group   
 Min.   :3.590   ctrl:10  
 1st Qu.:4.550   trt1:10  
 Median :5.155   trt2:10  
 Mean   :5.073            
 3rd Qu.:5.530            
 Max.   :6.310            </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bayes_t_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We will use this as an example data set, specifically weâ€™ll use <code>ctrl</code> and <code>trt2</code> data, which we need to extract. Note the mean values for <code>trt2</code> look larger than <code>ctrl</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pg_small <span class="ot">&lt;-</span> PlantGrowth <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"trt2"</span>, <span class="st">"ctrl"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>letâ€™s calculate too the sample difference mean and the standardised effect size, as it will be important to know these values later</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pg_small <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>( <span class="at">names_from =</span> group, <span class="at">values_from =</span> mean_weight) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_sample_diff =</span> <span class="st">`</span><span class="at">trt2</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">ctrl</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 1
  mean_sample_diff
             &lt;dbl&gt;
1            0.494</code></pre>
</div>
</div>
<p>So the mean of <code>trt2</code> is bigger than <code>ctrl</code> by 0.49 g.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(weight <span class="sc">~</span> group, <span class="at">data=</span>pg_small)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d |         95% CI
--------------------------
-0.95     | [-1.87, -0.01]

- Estimated using pooled SD.</code></pre>
</div>
</div>
<p>And correspondingly the standardised effect size is large. The effect size is negative because the calculation has been done in the order that the groups appear in the data. <code>ctrl</code> comes first so the calculation was <code>ctrl</code> - <code>trt2</code> which is a negative value. For now, this wonâ€™t matter. We will need to pay attention to it later.</p>
</section>
<section id="two-sample-t-test" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="two-sample-t-test"><span class="header-section-number">2.2.2</span> Two Sample <span class="math inline">\(t\)</span>-test</h3>
<p>Letâ€™s now do the <span class="math inline">\(t\)</span>-tests. The hypotheses for a test comparing the treatment groups are</p>
<ul>
<li><span class="math inline">\(H_0 : \bar{trt2} - \bar{ctrl} = 0\)</span> IE the mean sample difference is 0</li>
<li><span class="math inline">\(H_1 : \bar{trt2} - \bar{ctrl} \neq 0\)</span> IE the mean sample difference is not 0</li>
</ul>
<p>Using these data to do a <span class="math inline">\(t\)</span>-test is easy, weâ€™ll specify a cut-off of 0.05 for rejection of <span class="math inline">\(H_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> pg_small)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ group, data = pg_small)

Residuals:
   Min     1Q Median     3Q    Max 
-0.862 -0.410 -0.006  0.280  1.078 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.0320     0.1637  30.742   &lt;2e-16 ***
grouptrt2     0.4940     0.2315   2.134   0.0469 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5176 on 18 degrees of freedom
Multiple R-squared:  0.2019,    Adjusted R-squared:  0.1576 
F-statistic: 4.554 on 1 and 18 DF,  p-value: 0.04685</code></pre>
</div>
</div>
<p>We get a <span class="math inline">\(p\)</span>-value of 0.046 which is less than our cut-off of 0.05 so we reject <span class="math inline">\(H_0\)</span> as unlikely and accept <span class="math inline">\(H_1\)</span> without explicitly testing it. Our conclusion scientifically is that <code>trt2</code> has greater <code>weight</code> than <code>ctrl</code>.</p>
</section>
</section>
<section id="a-bayesian-t-test" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="a-bayesian-t-test"><span class="header-section-number">2.3</span> A Bayesian <span class="math inline">\(t\)</span>-test</h2>
<p>Now letâ€™s set up a BayesFactor <span class="math inline">\(t\)</span>-test. First we must set our hypotheses. The null hypothesis is similar to that in the frequentist <span class="math inline">\(t\)</span>-test, the idea is that there is no effect which we formulated above as</p>
<ul>
<li><span class="math inline">\(H_0 : \bar{trt2} - \bar{ctrl} = 0\)</span> IE the mean sample difference is 0</li>
</ul>
<p>Another way to say this is that the effect size <span class="math inline">\(d\)</span> is 0 so</p>
<ul>
<li><span class="math inline">\(H_0 : d = 0\)</span></li>
</ul>
<p>Because we need something to compare against we now need to form the alternative hypothesis. By default the <code>ttestBF()</code> function tests the alternative hypothesis that the effect size is not 0</p>
<ul>
<li><span class="math inline">\(H_1 : d \neq 0\)</span></li>
</ul>
<p>and returns the Bayes Factor we need. Performing the test is straightforward</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">formula =</span>  weight <span class="sc">~</span> group, <span class="at">data =</span> pg_small)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.707 : 1.774688 Â±0%

Against denominator:
  Null, mu1-mu2 = 0 
---
Bayes factor type: BFindepSample, JZS</code></pre>
</div>
</div>
<p>We get a clear answer, the output on the line marked<code>[1]</code> is a Bayes Factor and states that the data are 1.77 times more likely if <span class="math inline">\(H_1\)</span> were true than if <span class="math inline">\(H_0\)</span> were true. In other words the odds of the data favouring the <span class="math inline">\(H_1\)</span> to <span class="math inline">\(H_0\)</span> are 1.77:1. Which is the answer we wanted to get, we have explicitly tested <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> and found that <span class="math inline">\(H_1\)</span> is more likely to fit the data.</p>
</section>
<section id="comparing-p-and-the-bayes-factor-for-the-plantgrowth-data" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="comparing-p-and-the-bayes-factor-for-the-plantgrowth-data"><span class="header-section-number">2.4</span> Comparing <span class="math inline">\(p\)</span> and the Bayes Factor for the PlantGrowth data</h2>
<p>Comparing to our table of interpretation of Bayes Factors, we see that this corresponds only to â€˜Anecdotal Evidenceâ€™ in favour of <span class="math inline">\(H_1\)</span>, which sounds weak and like really there isnâ€™t much evidence for the idea that the two samples are different. Do we find this surprising given that the <span class="math inline">\(p\)</span>-value from the <span class="math inline">\(t\)</span>-test was significant? Does this mean that the two methods disagree? Strictly speaking, no, we shouldnâ€™t be surprised and no they donâ€™t disagree.</p>
<p>Itâ€™s a bit of an apples and oranges situation. The two values are answers to very different questions.</p>
<p>As weâ€™ve said before the frequentist <span class="math inline">\(p\)</span>-value only measures the proportion of times a difference of the measured size would occur under some presumed background model. It does not measure the evidence that the hypothesis is true even though that is how many people try to interpret it. <span class="math inline">\(p\)</span> only tells us how often we would be wrong if we reject <span class="math inline">\(H_0\)</span>. As a result, many philosophers have stated that <span class="math inline">\(p\)</span> based significance is a fundamentally uninteresting measure - who cares how often a difference occurs in some ideal world - what is important is the relative fit of the competing hypotheses to the data and that this measure of the strength of evidence per hypothesis is more in line with the interests of researchers.</p>
<p>Taken together our <span class="math inline">\(p\)</span>-value states that the difference between the means of <code>trt2</code> and <code>ctrl</code> we observed occurs by chance in a normal distribution less than 0.05% of the time and the Bayes Factor tells us that the odds that the data favour the idea that <code>trt2</code> is not the same as <code>ctrl</code> are only 1.7 times greater than the idea that <code>trt2</code> and <code>ctrl</code> are equal. We can see that the two methods do not contradict.</p>
<p>Hopefully this brings home the idea that Bayes Factor is different and arguably closer to what many scientists think they are doing when they do frequentist statistics.</p>
<p>Interpreting these results correctly, then, logically means that a researcher is not likely to be very excited by the results and would not over value the significance of the observed difference.</p>
</section>
<section id="better-hypotheses---one-tailed-tests" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="better-hypotheses---one-tailed-tests"><span class="header-section-number">2.5</span> Better Hypotheses - One-tailed tests</h2>
<p>But looking at the hypotheses we generated, could we ask a better, more informative one? With frequentist tests, no, but with Bayes Factors we can test different hypothesis. Instead of asking whether <code>trt2</code> is the same as <code>ctrl</code> or not we could ask something more specific. We are likely interested in whether <code>trt2</code> is greater than <code>ctrl</code>, or in other words that the effect size is greater than 0</p>
<ul>
<li><span class="math inline">\(H_1 : d &gt; 0\)</span></li>
</ul>
<p>We can specify this <span class="math inline">\(H_1\)</span> by setting the <code>nullInterval</code> argument, this is just the range we expect the effect sizes to be in under the null hypothesis, so we can use 0 to Infinity to cover any increased effect size (and -Infinity to 0 for any decreased effect size.</p>
<section id="a-data-frame-based-gotcha" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="a-data-frame-based-gotcha"><span class="header-section-number">2.5.1</span> A data frame based gotcha</h3>
<p>Here is where we can run afoul of Râ€™s idiosyncarcies - it is important to be careful here because the order of the data in the dataframe can have an effect that can confuse us. Recall that our effect size calculation for these data came out negative because <code>ctrl</code> came before <code>trt2</code>. Look at the dataframe <code>pg_small</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pg_small)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  2 variables:
 $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
 $ group : Factor w/ 2 levels "ctrl","trt2": 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>Note that the <code>ctrl</code> level in the <code>group</code> factor is first, we need to think of our <span class="math inline">\(H_1\)</span> more carefully,</p>
<ul>
<li><span class="math inline">\(H_1 : d &gt; 0\)</span></li>
</ul>
<p>really is in this case</p>
<ul>
<li><span class="math inline">\(H_1 : \bar{\text{trt2}} - \bar{\text{ctrl}} &gt; 0\)</span></li>
</ul>
<p>so we need to make sure that <code>trt2</code> comes first in the <code>group</code> factor. We can use the <code>$</code> notation to reorder the factor as we wish</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pg_small<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(pg_small<span class="sc">$</span>group, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"trt2"</span>, <span class="st">"ctrl"</span>) )</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pg_small)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  2 variables:
 $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
 $ group : Factor w/ 2 levels "trt2","ctrl": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
</section>
</section>
<section id="performing-the-one-tailed-test" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="performing-the-one-tailed-test"><span class="header-section-number">2.6</span> Performing the One-tailed test</h2>
<p>With that done we can move back on with the one-sided test, specifying the interval as expected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">formula =</span>  weight <span class="sc">~</span> group, <span class="at">data =</span> pg_small, <span class="at">nullInterval=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">Inf</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.707 0&lt;d&lt;Inf    : 3.387166  Â±0%
[2] Alt., r=0.707 !(0&lt;d&lt;Inf) : 0.1622109 Â±0%

Against denominator:
  Null, mu1-mu2 = 0 
---
Bayes factor type: BFindepSample, JZS</code></pre>
</div>
</div>
<p>Performing the test was nice and easy and we get an answer. The first line of the output <code>[1]</code> states the odds that the data favour the alternative hypothesis over the null are 3.38:1. The Bayes Factor is increased over the earlier more vague hypothesis, suggesting there is actually substantial evidence for the idea that the effect size is greater than 0.</p>
</section>
<section id="testing-the-effect-of-the-prior" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="testing-the-effect-of-the-prior"><span class="header-section-number">2.7</span> Testing the effect of the prior</h2>
<p>We discussed that one of the limitations of Bayesian Inference was the need to carefully and justifiably select a prior and that doing so was difficult. Weâ€™ll look at that a little bit now as we did make a decision on this albeit implicitly by allowing the defaults of the <code>ttestBF()</code> function.</p>
<p>In our <code>ttestBF()</code> function we actually need to provide a prior distribution for the maths to work, not just a single value. We donâ€™t want to get into details of those maths as they are out of scope but we do need to know that the prior distribution needs to cover a range of effect sizes that might be plausible if the null hypothesis were false.</p>
<p>The <code>BayesFactor</code> package provides a Cauchy distribution as default. Since the selection of the prior implies that we know something about our dat, using the Cauchy implies that we think the population is normally distributed (which is the same distribution we assume under the standard frequentist statistical tests).</p>
<section id="the-cauchy-prior-distribution" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="the-cauchy-prior-distribution"><span class="header-section-number">2.7.1</span> The Cauchy Prior Distribution</h3>
<p>The Cauchy is a distribution with a single parameter called <code>scale</code> that affects how wide its main humpy bit is. In <code>BayesFactor</code> there are three widths we can choose from depending on how big a difference we think we are seeing, that is how big the effect size. When plotted, these distributions look like this</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bayes_t_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>and the <code>name</code> corresponds to <code>scale</code> values as follows</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">medium</td>
<td style="text-align: right;">0.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">wide</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ultrawide</td>
<td style="text-align: right;">1.41</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In each of the distributions 50% of the area under the curve falls within +/- the scale value.</p>
<p>Since the scale on the <span class="math inline">\(x\)</span>-axis in our plot is effect size, the choice of scale values says somerthing about what we are expecting our effect sizes to be like. The wider the scale value, the bigger we are expecting our effect sizes to be.</p>
<p>Our effect size in the <code>PlantGrowth</code> data was 0.95 so well within the area covered by the <code>medium</code> scale Cauchy, much more of that curve falls within the -0.95 to +0.95 effect size range than the other two, so we might think that one would be a better fit. Thatâ€™s why itâ€™s the default, itâ€™s a good fit for generally found effect sizes.</p>
</section>
<section id="the-effect-of-changing-the-prior" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="the-effect-of-changing-the-prior"><span class="header-section-number">2.7.2</span> The effect of changing the prior</h3>
<p>As an exercise to help us understand the importance of the prior and explicitly NOT a guide to maximising the odds in favour of one model over another. Letâ€™s look at how changing the scale via the <code>rscale</code> parameter in <code>ttestBF()</code> affects the odds of our one sided model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">formula =</span>  weight <span class="sc">~</span> group, <span class="at">data =</span> pg_small, <span class="at">nullInterval=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">Inf</span>), <span class="at">rscale=</span><span class="st">"medium"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.707 0&lt;d&lt;Inf    : 3.387166  Â±0%
[2] Alt., r=0.707 !(0&lt;d&lt;Inf) : 0.1622109 Â±0%

Against denominator:
  Null, mu1-mu2 = 0 
---
Bayes factor type: BFindepSample, JZS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">formula =</span>  weight <span class="sc">~</span> group, <span class="at">data =</span> pg_small, <span class="at">nullInterval=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">Inf</span>), <span class="at">rscale=</span><span class="st">"wide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=1 0&lt;d&lt;Inf    : 3.22134   Â±0%
[2] Alt., r=1 !(0&lt;d&lt;Inf) : 0.1189759 Â±0.02%

Against denominator:
  Null, mu1-mu2 = 0 
---
Bayes factor type: BFindepSample, JZS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">formula =</span>  weight <span class="sc">~</span> group, <span class="at">data =</span> pg_small, <span class="at">nullInterval=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">Inf</span>), <span class="at">rscale=</span><span class="st">"ultrawide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=1.414 0&lt;d&lt;Inf    : 2.857414   Â±0%
[2] Alt., r=1.414 !(0&lt;d&lt;Inf) : 0.08596477 Â±0.05%

Against denominator:
  Null, mu1-mu2 = 0 
---
Bayes factor type: BFindepSample, JZS</code></pre>
</div>
</div>
<p>Indeed we do get stronger odds for the alternative hypothesis in the <code>medium</code> scale than the others. Note that it isnâ€™t wise to go Bayes Factor fishing by post-hoc selecting the prior in order to maximise the Bayes Factor. This example was an exercise to show that prior selection is important.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Roundup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Bayes Factor <span class="math inline">\(t\)</span>-tests allow us to directly compare hypothesis about data in a way that is analogous to <span class="math inline">\(t\)</span>-tests.</li>
<li>We can compare different hypotheses</li>
<li>The interpretation of a BayesFactor tells us which of the hypotheses are favoured by the data</li>
<li>Prior selection is important, but <code>ttestBF()</code> restricts us to sensible options for data we assume to be normal</li>
</ul>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./bayes_factor_intro.html" class="pagination-link" aria-label="Bayesian Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bayes_anova.html" class="pagination-link" aria-label="Bayes Factor ANOVA">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayes Factor ANOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>